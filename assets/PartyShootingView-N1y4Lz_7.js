import{r as l,j as e,u as T}from"./index-KIJC1Cg9.js";import{s as F,f as $}from"./db-DFX2GImZ.js";import"./firebase-Codym4C1.js";function L({eventData:n}){const[f,x]=l.useState(!1),[c,v]=l.useState(Date.now());return l.useEffect(()=>{const i=setInterval(()=>v(Date.now()),1e3);return()=>clearInterval(i)},[]),l.useEffect(()=>{if(n?.broadcast?.overlay?.active){const{timestamp:i,duration:m,permanent:b}=n.broadcast.overlay;b||Date.now()-i<m*1e3?x(!0):x(!1)}else x(!1)},[n?.broadcast?.overlay,c]),e.jsxs(e.Fragment,{children:[f&&n?.broadcast?.overlay&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",background:"rgba(0,0,0,0.9)",animation:"fadeIn 0.3s ease-out"},children:e.jsx("div",{className:"glass",style:{padding:"4rem",border:"4px solid var(--accent-danger)",borderRadius:"24px",background:"rgba(239, 68, 68, 0.1)",boxShadow:"0 0 50px rgba(220, 38, 38, 0.5)",textAlign:"center",maxWidth:"90vw",willChange:"transform, opacity",animation:"popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:e.jsx("h1",{className:"text-gradient",style:{fontSize:"5rem",margin:0,textTransform:"uppercase",color:"white",textShadow:"0 0 20px var(--accent-danger)",lineHeight:1.2},children:n.broadcast.overlay.message})})}),n?.broadcast?.ticker?.active&&e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,width:"100%",background:"rgba(2, 6, 23, 0.95)",borderTop:"2px solid var(--accent-primary)",color:"white",padding:"1.5rem 0",zIndex:9998,overflow:"hidden",boxShadow:"0 -5px 20px rgba(0,0,0,0.5)"},children:[e.jsx("div",{style:{display:"inline-block",whiteSpace:"nowrap",animation:`marquee ${Math.max(5,45-(n.broadcast.ticker.speed||5)*4)}s linear infinite`,fontSize:"2rem",fontWeight:"800",textTransform:"uppercase",color:"var(--accent-primary)",textShadow:"0 0 10px rgba(29, 185, 84, 0.3)",letterSpacing:"2px",willChange:"transform"},children:[...Array(6)].map((i,m)=>e.jsxs("span",{children:[n.broadcast.ticker.message," Â  â€¢ Â "]},m))}),e.jsx("style",{children:`
                        @keyframes marquee {
                            0% { transform: translateX(0); }
                            100% { transform: translateX(-50%); } 
                        }
                        @keyframes popIn {
                            from { transform: scale(0.5); opacity: 0; }
                            to { transform: scale(1); opacity: 1; }
                        }
                    `})]})]})}function H(){const{eventId:n}=T(),[f,x]=l.useState([]),[c,v]=l.useState(null),[i,m]=l.useState(null),[b,S]=l.useState(null),[h,u]=l.useState(!1),g=l.useRef(null),j=l.useRef(null),[E,z]=l.useState(1),k=1600,_=900;l.useEffect(()=>{const t=()=>{if(j.current){const{clientWidth:r,clientHeight:o}=j.current,s=r/k,a=o/_,d=Math.min(s,a);z(d)}};return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[]),l.useEffect(()=>{c?.shooting?.activeShooterId?u(!0):u(!1)},[c?.shooting?.activeShooterId]),l.useEffect(()=>{let t=null;if(h){const r=JSON.parse(localStorage.getItem("pitmaster_settings")||"{}"),o=r.cameraDeviceId?{deviceId:{exact:r.cameraDeviceId}}:!0;navigator.mediaDevices.getUserMedia({video:o}).then(s=>{t=s,g.current&&(g.current.srcObject=t,g.current.play())}).catch(s=>{console.error("Camera error:",s),u(!1)})}return()=>{t&&t.getTracks().forEach(r=>r.stop())}},[h]);const p=t=>{const r=(t.round1||[]).reduce((s,a)=>s+(a||0),0),o=(t.round2||[]).reduce((s,a)=>s+(a||0),0);return r+o};if(l.useEffect(()=>{const t=F(n,o=>{v(o)}),r=$(n,o=>{const s=o.sort((a,d)=>p(d)-p(a));if(s.length>0){const a=s[0];i&&i.id!==a.id&&(S(`ðŸ‘‘ Neuer FÃ¼hrender: ${a.name} ðŸ‘‘`),setTimeout(()=>S(null),5e3)),m(a)}x(s)});return()=>{r(),t&&t()}},[n]),!c)return e.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-900 text-white",children:"Lade..."});const R=f.slice(0,3),I=f.slice(3);return e.jsxs("div",{ref:j,className:"w-screen h-screen bg-slate-900 overflow-hidden flex items-center justify-center relative select-none cursor-none",children:[e.jsx(L,{eventData:c}),e.jsxs("div",{className:"absolute inset-0 z-0 bg-slate-950",children:[e.jsx("div",{className:"absolute inset-0 opacity-30 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-green-900 via-slate-950 to-slate-950"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1/3 bg-gradient-to-t from-emerald-900/20 to-transparent"})]}),e.jsxs("div",{style:{width:`${k}px`,height:`${_}px`,transform:`scale(${E})`,flexShrink:0,position:"relative",zIndex:10,display:"grid",gridTemplateColumns:"65% 35%",gap:"40px",padding:"40px"},children:[e.jsx("div",{className:"flex flex-col gap-6 justify-center",children:R.map((t,r)=>{let o="var(--glass-border)",s="rgba(15, 23, 42, 0.6)",a="",d=null,C=1,w="text-slate-500";return r===0?(o="#fbbf24",s="rgba(251, 191, 36, 0.15)",a="shadow-[0_0_30px_rgba(251,191,36,0.3)] border-yellow-500/50",d="ðŸ‘‘",C=1.05,w="text-yellow-400"):r===1?(o="#94a3b8",s="rgba(148, 163, 184, 0.15)",a="shadow-[0_0_20px_rgba(148,163,184,0.2)] border-slate-400/50",w="text-slate-300"):r===2&&(o="#b45309",s="rgba(180, 83, 9, 0.15)",a="shadow-[0_0_20px_rgba(180,83,9,0.2)] border-amber-700/50",w="text-amber-700"),e.jsxs("div",{className:`relative rounded-3xl border-2 flex items-center p-6 gap-8 backdrop-blur-md transition-all duration-500 ${a}`,style:{borderColor:r>0?o:void 0,background:s,transform:`scale(${C})`,zIndex:10-r},children:[e.jsxs("div",{className:`text-6xl font-bold w-24 text-center ${w}`,style:{fontFamily:'"Neon Glow", sans-serif',textShadow:"0 0 10px currentColor"},children:[r+1,"."]}),e.jsx("div",{className:"w-32 h-32 rounded-full border-4 shadow-lg overflow-hidden flex-shrink-0",style:{borderColor:o},children:t.image?e.jsx("img",{src:t.image,className:"w-full h-full object-cover",alt:""}):e.jsx("div",{className:"w-full h-full bg-slate-800 flex items-center justify-center text-4xl",children:"ðŸ‘¤"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-5xl font-bold text-white truncate mb-2 leading-tight tracking-wide",style:{textShadow:"0 2px 4px rgba(0,0,0,0.5)"},children:[t.name," ",d]}),e.jsxs("div",{className:"flex gap-8 text-2xl text-slate-400 font-mono",children:[e.jsxs("span",{className:"bg-black/30 px-3 py-1 rounded-lg border border-white/5",children:["R1: ",e.jsx("b",{className:"text-white",children:(t.round1||[]).reduce((y,N)=>y+(N||0),0)})]}),e.jsxs("span",{className:"bg-black/30 px-3 py-1 rounded-lg border border-white/5",children:["R2: ",e.jsx("b",{className:"text-white",children:(t.round2||[]).reduce((y,N)=>y+(N||0),0)})]})]})]}),e.jsx("div",{className:"text-8xl font-black text-emerald-400 tracking-tighter",style:{fontFamily:'"Neon Glow", sans-serif',textShadow:"0 0 20px rgba(52, 211, 153, 0.6)"},children:p(t)})]},t.id)})}),e.jsx("div",{className:"glass flex flex-col h-full overflow-hidden rounded-3xl border border-emerald-500/30 shadow-[0_0_30px_rgba(16,185,129,0.1)] relative",children:h?e.jsxs("div",{className:"absolute inset-0 z-20 bg-black flex flex-col border-4 border-red-600 animate-pulse-slow",children:[e.jsxs("div",{className:"bg-red-600 text-white text-2xl font-bold px-4 py-2 flex items-center gap-3 font-mono",children:[e.jsx("span",{className:"animate-pulse",children:"ðŸ”´"})," LIVE CAM"]}),e.jsx("video",{ref:g,className:"flex-1 w-full h-full object-cover",muted:!0})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-slate-900/80 p-6 border-b border-white/10 backdrop-blur-xl",children:e.jsx("h3",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400 uppercase tracking-widest text-center",style:{fontFamily:'"Neon Glow", sans-serif'},children:"Verfolgerfeld"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar",children:[I.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-800/40 hover:bg-slate-700/50 transition-colors rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-slate-500 font-mono w-10 text-xl text-right",children:[r+4,"."]}),t.image?e.jsx("img",{src:t.image,className:"w-12 h-12 rounded-full object-cover border border-white/10",alt:""}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-700 flex items-center justify-center text-xl border border-white/10",children:"ðŸ‘¤"}),e.jsx("span",{className:"text-2xl font-semibold text-slate-200",children:t.name})]}),e.jsx("span",{className:"text-4xl font-bold text-emerald-500",style:{fontFamily:'"Neon Glow", sans-serif'},children:p(t)})]},t.id)),I.length===0&&e.jsx("div",{className:"text-center text-slate-600 mt-20 text-xl italic p-10 border-2 border-dashed border-slate-800 rounded-2xl mx-10",children:"Warte auf weitere SchÃ¼tzen..."})]})]})}),b&&e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 bg-black/90 border-4 border-emerald-500 px-20 py-12 rounded-3xl shadow-[0_0_100px_rgba(16,185,129,0.8)] text-center animate-bounce-in backdrop-blur-xl",children:e.jsx("h2",{className:"text-7xl font-black text-emerald-400 leading-tight whitespace-nowrap",style:{fontFamily:'"Neon Glow", sans-serif',textShadow:"0 0 30px currentColor"},children:b})})]}),e.jsx("button",{onClick:()=>u(!h),className:"fixed top-4 right-4 opacity-0 hover:opacity-100 transition-opacity p-4 bg-white text-black rounded-full z-50 font-bold shadow-lg",children:"ðŸ“· Toggle Cam"})]})}export{H as default};
