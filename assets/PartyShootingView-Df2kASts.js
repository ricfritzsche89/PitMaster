import{r as l,j as e,u as R}from"./index-B1r4LNsz.js";import{s as T,f as L}from"./db-BWq_IH56.js";import"./firebase-Codym4C1.js";function _({eventData:i}){const[f,x]=l.useState(!1),[c,v]=l.useState(Date.now());return l.useEffect(()=>{const o=setInterval(()=>v(Date.now()),1e3);return()=>clearInterval(o)},[]),l.useEffect(()=>{if(i?.broadcast?.overlay?.active){const{timestamp:o,duration:m,permanent:h}=i.broadcast.overlay;h||Date.now()-o<m*1e3?x(!0):x(!1)}else x(!1)},[i?.broadcast?.overlay,c]),e.jsxs(e.Fragment,{children:[f&&i?.broadcast?.overlay&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",background:"rgba(0,0,0,0.9)",animation:"fadeIn 0.3s ease-out"},children:e.jsx("div",{className:"glass",style:{padding:"4rem",border:"4px solid var(--accent-danger)",borderRadius:"24px",background:"rgba(239, 68, 68, 0.1)",boxShadow:"0 0 50px rgba(220, 38, 38, 0.5)",textAlign:"center",maxWidth:"90vw",willChange:"transform, opacity",animation:"popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)"},children:e.jsx("h1",{className:"text-gradient",style:{fontSize:"5rem",margin:0,textTransform:"uppercase",color:"white",textShadow:"0 0 20px var(--accent-danger)",lineHeight:1.2},children:i.broadcast.overlay.message})})}),i?.broadcast?.ticker?.active&&e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,width:"100%",background:"rgba(2, 6, 23, 0.95)",borderTop:"2px solid var(--accent-primary)",color:"white",padding:"1.5rem 0",zIndex:9998,overflow:"hidden",boxShadow:"0 -5px 20px rgba(0,0,0,0.5)"},children:[e.jsx("div",{style:{display:"inline-block",whiteSpace:"nowrap",animation:`marquee ${Math.max(5,45-(i.broadcast.ticker.speed||5)*4)}s linear infinite`,fontSize:"2rem",fontWeight:"800",textTransform:"uppercase",color:"var(--accent-primary)",textShadow:"0 0 10px rgba(29, 185, 84, 0.3)",letterSpacing:"2px",willChange:"transform"},children:[...Array(6)].map((o,m)=>e.jsxs("span",{children:[i.broadcast.ticker.message," Â  â€¢ Â "]},m))}),e.jsx("style",{children:`
                        @keyframes marquee {
                            0% { transform: translateX(0); }
                            100% { transform: translateX(-50%); } 
                        }
                        @keyframes popIn {
                            from { transform: scale(0.5); opacity: 0; }
                            to { transform: scale(1); opacity: 1; }
                        }
                    `})]})]})}function H(){const{eventId:i}=R(),[f,x]=l.useState([]),[c,v]=l.useState(null),[o,m]=l.useState(null),[h,N]=l.useState(null),[u,b]=l.useState(!1),g=l.useRef(null),w=l.useRef(null),[E,z]=l.useState(1),S=1600,k=900;l.useEffect(()=>{const t=()=>{if(w.current){const{clientWidth:s,clientHeight:r}=w.current,a=s/S,n=r/k,d=Math.min(a,n);z(d)}};return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[]),l.useEffect(()=>{c?.shooting?.activeShooterId?b(!0):b(!1)},[c?.shooting?.activeShooterId]),l.useEffect(()=>{let t=null;if(u){const s=JSON.parse(localStorage.getItem("pitmaster_settings")||"{}"),r=s.cameraDeviceId?{deviceId:{exact:s.cameraDeviceId}}:!0;navigator.mediaDevices.getUserMedia({video:r}).then(a=>{t=a,g.current&&(g.current.srcObject=t,g.current.play())}).catch(a=>{console.error("Camera error:",a),b(!1)})}return()=>{t&&t.getTracks().forEach(s=>s.stop())}},[u]);const p=t=>{const s=(t.round1||[]).reduce((a,n)=>a+(n||0),0),r=(t.round2||[]).reduce((a,n)=>a+(n||0),0);return s+r};if(l.useEffect(()=>{const t=T(i,r=>{v(r)}),s=L(i,r=>{const a=r.sort((n,d)=>p(d)-p(n));if(a.length>0){const n=a[0];o&&o.id!==n.id&&(N(`ðŸ‘‘ Neuer FÃ¼hrender: ${n.name} ðŸ‘‘`),setTimeout(()=>N(null),5e3)),m(n)}x(a)});return()=>{s(),t&&t()}},[i]),!c)return e.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-900 text-white",children:"Lade..."});const C=f.slice(0,3),I=f.slice(3);return e.jsxs("div",{ref:w,className:"w-screen h-screen bg-slate-900 overflow-hidden flex items-center justify-center relative select-none cursor-none",children:[e.jsx(_,{eventData:c}),e.jsx("div",{className:"absolute inset-0 z-0 bg-radial-gradient from-emerald-500/10 to-transparent opacity-50 pointer-events-none"}),e.jsxs("div",{style:{width:`${S}px`,height:`${k}px`,transform:`scale(${E})`,flexShrink:0,position:"relative",background:"rgba(255,255,255,0)",display:"grid",gridTemplateColumns:"65% 35%",gap:"40px",padding:"40px"},children:[e.jsx("div",{className:"flex flex-col gap-6 justify-center",children:C.map((t,s)=>{let r="rgba(255,255,255,0.1)",a="rgba(255,255,255,0.05)",n=null,d=1;return s===0&&(r="#fbbf24",a="rgba(251, 191, 36, 0.1)",n="ðŸ‘‘",d=1.05),s===1&&(r="#94a3b8"),s===2&&(r="#b45309"),e.jsxs("div",{className:"relative rounded-3xl border-2 flex items-center p-6 gap-8 backdrop-blur-md shadow-2xl",style:{borderColor:r,background:a,transform:`scale(${d})`,zIndex:10-s},children:[e.jsxs("div",{className:"text-6xl font-bold w-24 text-center",style:{color:r},children:[s+1,"."]}),e.jsx("div",{className:"w-32 h-32 rounded-full border-4 shadow-lg overflow-hidden flex-shrink-0",style:{borderColor:r},children:t.image?e.jsx("img",{src:t.image,className:"w-full h-full object-cover",alt:""}):e.jsx("div",{className:"w-full h-full bg-slate-700 flex items-center justify-center text-4xl",children:"ðŸ‘¤"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-5xl font-bold text-white truncate mb-2 leading-tight",children:[t.name," ",n]}),e.jsxs("div",{className:"flex gap-8 text-2xl text-slate-400",children:[e.jsxs("span",{children:["R1: ",e.jsx("b",{className:"text-white",children:(t.round1||[]).reduce((j,y)=>j+(y||0),0)})]}),e.jsxs("span",{children:["R2: ",e.jsx("b",{className:"text-white",children:(t.round2||[]).reduce((j,y)=>j+(y||0),0)})]})]})]}),e.jsx("div",{className:"text-8xl font-black text-emerald-400 font-mono tracking-tighter",children:p(t)})]},t.id)})}),e.jsx("div",{className:"flex flex-col h-full overflow-hidden rounded-3xl border border-slate-700 bg-slate-800/40 backdrop-blur-sm shadow-xl relative",children:u?e.jsxs("div",{className:"absolute inset-0 z-20 bg-black flex flex-col border-4 border-red-600 animate-pulse-slow",children:[e.jsxs("div",{className:"bg-red-600 text-white text-2xl font-bold px-4 py-2 flex items-center gap-3",children:[e.jsx("span",{className:"animate-pulse",children:"ðŸ”´"})," LIVE CAM"]}),e.jsx("video",{ref:g,className:"flex-1 w-full h-full object-cover",muted:!0})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-slate-800 p-6 border-b border-slate-700",children:e.jsx("h3",{className:"text-2xl font-bold text-slate-300 uppercase tracking-widest",children:"Verfolgerfeld"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[I.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-800/50 rounded-xl border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-slate-500 font-mono w-8 text-xl text-right",children:[s+4,"."]}),t.image&&e.jsx("img",{src:t.image,className:"w-10 h-10 rounded-full object-cover",alt:""}),e.jsx("span",{className:"text-xl font-semibold text-slate-200",children:t.name})]}),e.jsx("span",{className:"text-3xl font-bold text-emerald-500 font-mono",children:p(t)})]},t.id)),I.length===0&&e.jsx("div",{className:"text-center text-slate-600 mt-10 text-xl italic",children:"Warte auf weitere SchÃ¼tzen..."})]})]})}),h&&e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 bg-black/95 border-4 border-emerald-500 px-20 py-12 rounded-3xl shadow-[0_0_100px_rgba(16,185,129,0.5)] text-center animate-bounce-in",children:e.jsx("h2",{className:"text-7xl font-black text-emerald-400 leading-tight whitespace-nowrap",children:h})})]}),e.jsx("button",{onClick:()=>b(!u),className:"fixed top-4 right-4 opacity-0 hover:opacity-50 transition-opacity p-4 bg-white text-black rounded-full z-50 font-bold",children:"ðŸ“· Toggle Cam"})]})}export{H as default};
