import{r as o,j as e}from"./index-CGZqZypT.js";import{g as y,u as k,r as N}from"./db-DqoeB3gf.js";function D({partyId:s}){const[n,p]=o.useState(null),[b,g]=o.useState(!0),[x,j]=o.useState(null),[i,u]=o.useState(""),[v,d]=o.useState(!1);o.useEffect(()=>{h();const t=localStorage.getItem(`pitmaster_guest_${s}`);t&&u(t)},[s]);const h=async()=>{try{g(!0);const t=await y(s);p(t);const r=localStorage.getItem(`pitmaster_guest_${s}`);r&&t.guests&&t.guests.find(l=>l.name===r)&&d(!0)}catch{j("Event nicht gefunden oder abgelaufen.")}g(!1)},m=async(t,r=!1)=>{if(!i.trim()){alert("Bitte gib deinen Namen ein!");return}try{await N(s,{name:i,status:t,participatesInCompetition:r,timestamp:Date.now()}),localStorage.setItem(`pitmaster_guest_${s}`,i),d(!0),h()}catch{alert("Fehler beim Senden der Antwort")}},S=t=>{if(!t)return"";const[r,a,l]=t.split("-");return`${l}.${a}.${r}`};return b?e.jsx("div",{className:"container",style:{textAlign:"center",marginTop:"4rem"},children:"Lade Party Infos..."}):x?e.jsx("div",{className:"container",style:{textAlign:"center",marginTop:"4rem",color:"#ef4444"},children:x}):e.jsx("div",{className:"content-container animate-fade-in",children:e.jsxs("div",{className:"glass card",style:{maxWidth:"600px",margin:"2rem auto",textAlign:"center",overflow:"hidden"},children:[n.image?e.jsx("div",{style:{margin:"-2rem -2rem 2rem -2rem",height:"250px",backgroundImage:`url(${n.image})`,backgroundSize:"cover",backgroundPosition:"center"}}):e.jsx("span",{style:{fontSize:"4rem",display:"block",marginBottom:"1rem",marginTop:"1rem"},children:"ğŸ‰"}),n.theme&&e.jsx("span",{style:{background:"var(--accent-primary)",color:"#000",fontWeight:"bold",padding:"4px 12px",borderRadius:"16px",fontSize:"0.8rem",textTransform:"uppercase",letterSpacing:"1px"},children:n.theme}),e.jsx("h1",{className:"text-gradient",style:{marginBottom:"0.5rem",marginTop:n.theme?"0.5rem":"0"},children:n.title}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"1rem",borderRadius:"12px",margin:"2rem 0",textAlign:"left"},children:[e.jsxs("p",{style:{margin:"0.5rem 0"},children:["ğŸ“… ",e.jsx("strong",{children:"Wann:"})," ",S(n.date)," um ",n.time]}),e.jsxs("p",{style:{margin:"0.5rem 0"},children:["ğŸ“ ",e.jsx("strong",{children:"Wo:"})," ",n.location]}),n.maxGuests>0&&e.jsxs("p",{style:{margin:"0.5rem 0"},children:["ğŸ‘¥ ",e.jsx("strong",{children:"Max GÃ¤ste:"})," ",n.maxGuests]}),e.jsxs("p",{style:{margin:"0.5rem 0",whiteSpace:"pre-wrap"},children:["ğŸ“ ",e.jsx("strong",{children:"Infos:"}),e.jsx("br",{}),n.description]})]}),v?e.jsxs("div",{className:"animate-fade-in",style:{padding:"2rem",background:"rgba(255,255,255,0.03)",borderRadius:"12px",border:"1px solid var(--accent-primary)"},children:[e.jsx("h3",{children:"Antwort gesendet!"}),e.jsxs("p",{children:["Danke fÃ¼r die RÃ¼ckmeldung, ",i,"."]}),e.jsxs("div",{style:{marginTop:"2rem",borderTop:"1px solid var(--glass-border)",paddingTop:"1rem",textAlign:"left"},children:[e.jsx("h4",{style:{marginBottom:"1rem"},children:"ğŸ Wer bringt was mit?"}),e.jsxs("ul",{style:{listStyle:"none",padding:0,marginBottom:"1rem"},children:[(n.bringList||[]).map((t,r)=>e.jsxs("li",{style:{marginBottom:"0.5rem",background:"rgba(255,255,255,0.05)",padding:"8px",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("strong",{style:{color:"var(--accent-primary)"},children:t.guest}),": ",t.item,t.note&&e.jsxs("span",{style:{opacity:.7},children:[" (",t.note,")"]})]},r)),(!n.bringList||n.bringList.length===0)&&e.jsx("li",{style:{opacity:.5,fontSize:"0.9rem"},children:"Noch bringt niemand etwas mit."})]}),e.jsx("h5",{style:{marginTop:"1rem",marginBottom:"0.5rem"},children:"Ich bringe was mit:"}),e.jsxs("form",{onSubmit:async t=>{t.preventDefault();const r=new FormData(t.target),a=r.get("item"),l=r.get("note");if(a)try{const c=await y(s),w={guest:i,item:a,note:l},f=[...c.bringList||[],w];await k(s,{bringList:f}),p({...c,bringList:f}),t.target.reset(),alert("Gespeichert! Danke "+i+"!")}catch(c){console.error(c),alert("Fehler beim Speichern. Versuch's nochmal.")}},style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{name:"item",required:!0,placeholder:"Was? (z.B. Brot)",className:"input-field",style:{marginBottom:0,flex:2}}),e.jsx("input",{name:"note",placeholder:"Notiz",className:"input-field",style:{marginBottom:0,flex:1}}),e.jsx("button",{type:"submit",className:"btn-primary",style:{padding:"0 1rem"},children:"+"})]})]}),i&&e.jsx("button",{onClick:()=>d(!1),style:{background:"none",border:"none",color:"var(--text-secondary)",textDecoration:"underline",cursor:"pointer",marginTop:"2rem"},children:"Antwort Ã¤ndern"})]}):e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h3",{style:{marginBottom:"1rem"},children:"Bist du dabei?"}),e.jsx("input",{placeholder:"Dein Name",className:"input-field",style:{maxWidth:"300px",textAlign:"center"},value:i,onChange:t=>u(t.target.value)}),n.theme==="SchieÃŸwettbewerb"&&e.jsx("div",{style:{marginTop:"1.5rem",background:"rgba(255,255,255,0.05)",padding:"10px",borderRadius:"12px"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",justifyContent:"center"},children:[e.jsx("input",{type:"checkbox",style:{transform:"scale(1.5)",accentColor:"var(--accent-primary)"},id:"participation-check"}),e.jsx("span",{style:{fontSize:"0.9rem"},children:"Ich nehme am SchieÃŸwettbewerb teil ğŸ¯"})]})}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem",width:"100%",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{const t=document.getElementById("participation-check")?.checked||!1;m("accepted",t)},className:"btn-primary",style:{flex:1,maxWidth:"140px"},children:"Bin dabei! ğŸš€"}),e.jsx("button",{onClick:()=>m("declined",!1),className:"btn-primary",style:{background:"transparent",border:"1px solid #ef4444",color:"#ef4444",flex:1,maxWidth:"140px"},children:"Kann nicht"})]}),e.jsx("button",{onClick:()=>m("maybe",!1),style:{background:"none",border:"none",color:"var(--text-secondary)",cursor:"pointer",fontSize:"0.9rem",marginTop:"0.5rem"},children:"Vielleicht... ğŸ¤”"})]})]}),e.jsxs("div",{style:{marginTop:"3rem",borderTop:"1px solid var(--glass-border)",paddingTop:"1rem"},children:[e.jsxs("h4",{children:["Wer kommt? (",n.guests?.filter(t=>t.status==="accepted").length||0,")"]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",justifyContent:"center"},children:[n.guests&&n.guests.map((t,r)=>e.jsxs("span",{style:{background:"rgba(255,255,255,0.1)",padding:"4px 12px",borderRadius:"20px",fontSize:"0.9rem",opacity:t.status==="declined"?.5:1,textDecoration:t.status==="declined"?"line-through":"none"},children:[t.name," ",t.status==="maybe"?"(Vielleicht)":""]},r)),(!n.guests||n.guests.length===0)&&e.jsx("span",{style:{opacity:.5},children:"Sei der Erste!"})]})]}),e.jsx("div",{style:{marginTop:"3rem",opacity:.5},children:e.jsx("button",{onClick:()=>{const t=prompt("ğŸ‘‘ Admin PIN eingeben:");if(t&&n.adminPin&&t===n.adminPin){const r=JSON.parse(localStorage.getItem("my_events")||"[]");r.includes(s)||(r.push(s),localStorage.setItem("my_events",JSON.stringify(r))),window.location.href=window.location.origin+window.location.pathname}else t&&alert("Falscher PIN! âŒ")},style:{background:"none",border:"none",color:"var(--text-muted)",fontSize:"0.8rem",cursor:"pointer"},children:"ğŸ‘‘ Admin Login"})})]})})}export{D as default};
