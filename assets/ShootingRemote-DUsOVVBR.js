import{u as B,a as I,r as s,j as t}from"./index-BMl4TAgx.js";import{s as T,f as P,u as W,h as F}from"./db-DD18zbe5.js";function Z(){const{eventId:a}=B(),h=I(),[p,f]=s.useState(null),[c,y]=s.useState([]),[o,m]=s.useState(""),[l,g]=s.useState(1),[i,u]=s.useState([null,null,null,null,null]),[d,b]=s.useState(!1);s.useEffect(()=>{const e=T(a,f),n=P(a,r=>{y(r.sort((E,z)=>E.name.localeCompare(z.name)))});return()=>{e(),n()}},[a]),s.useEffect(()=>{if(a)return W(a,{"shooting.activeShooterId":o||null}).catch(e=>console.error("Failed to update active shooter",e)),()=>{}},[o,a]),s.useEffect(()=>{if(o){const e=c.find(n=>n.id===o);if(e){const n=l===1?e.round1:e.round2;u(n||[null,null,null,null,null])}}else u([null,null,null,null,null])},[o,l,c]);const S=(e,n)=>{const r=[...i];r[e]=n===""?null:parseInt(n),u(r)},v=async()=>{if(o){b(!0);try{await F(a,o,l===1?{round1:i}:{round2:i}),m(""),alert(`‚úÖ Runde ${l} gespeichert!`)}catch(e){alert("Fehler: "+e.message)}b(!1)}};if(!p)return t.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#fff"},children:"Lade Event..."});const j=i.reduce((e,n)=>e+(n||0),0),w={minHeight:"100vh",background:"#020617",color:"white",padding:"1rem",paddingBottom:"5rem",fontFamily:"Outfit, sans-serif"},k={display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",borderBottom:"1px solid rgba(255,255,255,0.1)",paddingBottom:"1rem"},x=e=>({padding:"1rem",borderRadius:"12px",fontWeight:"bold",fontSize:"1.2rem",border:e?"2px solid #34d399":"1px solid rgba(255,255,255,0.2)",background:e?"rgba(16, 185, 129, 0.2)":"rgba(30, 41, 59, 0.5)",color:e?"#34d399":"#94a3b8",cursor:"pointer",transition:"all 0.2s",flex:1,textAlign:"center",boxShadow:e?"0 0 15px rgba(16, 185, 129, 0.2)":"none"}),R={width:"100%",aspectRatio:"1",background:"#1e293b",border:"2px solid #475569",borderRadius:"12px",fontSize:"2rem",fontWeight:"bold",color:"white",textAlign:"center",outline:"none",transition:"all 0.2s"},C={width:"100%",background:"linear-gradient(135deg, #059669 0%, #10b981 100%)",color:"white",border:"none",padding:"1.5rem",borderRadius:"16px",fontSize:"1.5rem",fontWeight:"bold",cursor:d?"not-allowed":"pointer",boxShadow:"0 0 20px rgba(16, 185, 129, 0.4)",marginTop:"2rem",opacity:d?.7:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem"};return t.jsxs("div",{style:w,children:[t.jsxs("div",{style:k,children:[t.jsxs("div",{children:[t.jsx("h1",{style:{margin:0,fontSize:"1.5rem",color:"#34d399",textTransform:"uppercase",letterSpacing:"1px"},children:"üéØ Remote"}),t.jsx("div",{style:{fontSize:"0.8rem",opacity:.6},children:p.title})]}),t.jsxs("div",{style:{background:"#1e293b",padding:"0.5rem 1rem",borderRadius:"8px",border:"1px solid #334155",fontWeight:"bold"},children:["R",l]})]}),t.jsxs("div",{style:{marginBottom:"2rem",position:"relative"},children:[t.jsx("label",{style:{display:"block",marginBottom:"0.5rem",color:"#94a3b8",fontSize:"0.9rem",textTransform:"uppercase",letterSpacing:"1px"},children:"Sch√ºtze ausw√§hlen"}),t.jsxs("select",{style:{width:"100%",background:"#1e293b",border:"2px solid #334155",borderRadius:"12px",padding:"1rem",fontSize:"1.2rem",color:"white",outline:"none",appearance:"none",backgroundImage:"none"},value:o,onChange:e=>m(e.target.value),children:[t.jsx("option",{value:"",children:"-- Bitte w√§hlen --"}),c.map(e=>t.jsxs("option",{value:e.id,children:[e.name," (",(e.round1?.reduce((n,r)=>n+(r||0),0)||0)+(e.round2?.reduce((n,r)=>n+(r||0),0)||0),")"]},e.id))]}),t.jsx("div",{style:{position:"absolute",right:"1rem",bottom:"1.2rem",pointerEvents:"none",color:"#94a3b8"},children:"‚ñº"})]}),o&&t.jsxs("div",{className:"animate-fade-in",children:[t.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem"},children:[t.jsx("button",{onClick:()=>g(1),style:x(l===1),children:"Runde 1"}),t.jsx("button",{onClick:()=>g(2),style:x(l===2),children:"Runde 2"})]}),t.jsxs("div",{style:{background:"rgba(30, 41, 59, 0.5)",padding:"1.5rem",borderRadius:"16px",border:"1px solid rgba(255,255,255,0.05)"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"1.5rem"},children:[t.jsx("label",{style:{color:"#94a3b8",fontSize:"0.9rem",textTransform:"uppercase"},children:"Ergebnisse (5 Schuss)"}),t.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#34d399",textShadow:"0 0 10px rgba(52,211,153,0.3)"},children:["Summe: ",j]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"10px"},children:i.map((e,n)=>t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[t.jsxs("span",{style:{fontSize:"0.8rem",color:"#64748b",marginBottom:"4px"},children:["#",n+1]}),t.jsx("input",{type:"number",min:"0",max:"12",value:e??"",placeholder:"-",onChange:r=>S(n,r.target.value),style:R,onFocus:r=>{r.target.style.borderColor="#34d399",r.target.style.boxShadow="0 0 15px rgba(52, 211, 153, 0.3)",r.target.style.background="#0f172a"},onBlur:r=>{r.target.style.borderColor="#475569",r.target.style.boxShadow="none",r.target.style.background="#1e293b"}})]},n))})]}),t.jsxs("button",{style:C,onClick:v,disabled:d,children:[t.jsx("span",{style:{fontSize:"1.8rem"},children:"üíæ"}),d?"SPEICHERT...":"SPEICHERN"]}),t.jsx("button",{onClick:()=>{window.confirm("Zur√ºck zur √úbersicht?")&&h("/")},style:{background:"none",border:"none",width:"100%",padding:"1rem",marginTop:"1rem",color:"#64748b",cursor:"pointer"},children:"Zur√ºck zum Menu"})]})]})}export{Z as default};
