import{u as $,r as a,j as e}from"./index-DDDCo864.js";import{s as _,g as C,p as E}from"./db-CW5sEvlW.js";import{c as W,a as D,f as h}from"./finance-GZNHdtyO.js";function G(){const{id:d}=$(),[n,w]=a.useState(null),[o,u]=a.useState(""),[N,f]=a.useState(!1),[l,A]=a.useState([]),[c,j]=a.useState({}),[p,b]=a.useState("winner"),[g,k]=a.useState(""),[v,S]=a.useState(5),[x,y]=a.useState([]),z=a.useRef(null);a.useEffect(()=>{const t=JSON.parse(localStorage.getItem(`my_bets_${d}`)||"[]");y(t);const s=localStorage.getItem(`pitmaster_guest_${d}`);s&&(u(s),f(!0)),I();const i=_(d,r=>{A(r),n&&n.guests&&j(W(r,n.guests))});return()=>i()},[d]);const T=t=>{t.trim()&&(localStorage.setItem(`pitmaster_guest_${d}`,t),u(t),f(!0))};a.useEffect(()=>{if(n&&n.guests&&j(W(l,n.guests)),o&&l.length>0){const t=l.filter(i=>i.user===o).map(i=>i.id),s=[...new Set([...x,...t])];s.length>x.length&&(y(s),localStorage.setItem(`my_bets_${d}`,JSON.stringify(s)))}},[n,l,o]);const I=async()=>{try{const t=await C(d);w(t)}catch(t){console.error(t)}},L=async t=>{if(t.preventDefault(),!g)return;const s=await E(d,{user:o,type:p,target:g,amount:parseFloat(v)}),i=[...x,s];y(i),localStorage.setItem(`my_bets_${d}`,JSON.stringify(i)),alert(`Wette platziert! Viel GlÃ¼ck, ${o}! ðŸ€`),S(5),setTimeout(()=>{z.current?.scrollIntoView({behavior:"smooth",block:"start"})},100)};if(!n)return e.jsx("div",{className:"container",style:{textAlign:"center",marginTop:"4rem"},children:"Lade WettbÃ¼ro..."});if(!N)return e.jsx("div",{className:"content-container animate-fade-in",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"80vh"},children:e.jsxs("div",{className:"glass card",style:{padding:"2rem",textAlign:"center",maxWidth:"400px",width:"100%"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"ðŸ•µï¸â€â™‚ï¸"}),e.jsx("h2",{style:{marginBottom:"0.5rem"},children:"Wer bist du?"}),e.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"Damit wir deine Wetten zuordnen kÃ¶nnen."}),e.jsxs("form",{onSubmit:t=>{t.preventDefault();const s=t.target.elements.name.value;T(s)},children:[e.jsx("input",{name:"name",className:"input-field",placeholder:"Dein Name",autoFocus:!0,style:{textAlign:"center",fontSize:"1.2rem"}}),e.jsx("button",{type:"submit",className:"btn-primary",style:{width:"100%",marginTop:"1rem"},children:"Los geht's! ðŸš€"})]})]})});const B=l.filter(t=>x.includes(t.id));return e.jsxs("div",{className:"container animate-fade-in",style:{paddingBottom:"6rem",maxWidth:"800px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem",padding:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0},children:"WettbÃ¼ro"}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:n.title})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",padding:"5px 12px",borderRadius:"20px",fontSize:"0.9rem"},children:["ðŸ‘¤ ",o]})]}),(!n.bettingStatus||n.bettingStatus==="closed")&&!n.bettingResults&&e.jsxs("div",{className:"glass card",style:{textAlign:"center",padding:"3rem",marginBottom:"2rem"},children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"â›”"}),e.jsx("h3",{children:"WettbÃ¼ro momentan geschlossen"}),e.jsx("p",{style:{opacity:.7},children:"Warte auf den Admin..."})]}),n.bettingResults&&(()=>{const t=D(l,n.bettingResults),i=t.filter(r=>r.user===o).reduce((r,m)=>r+m.amount,0);return l.filter(r=>r.user===o).reduce((r,m)=>r+m.amount,0),e.jsxs("div",{className:"glass card",style:{padding:"0",marginBottom:"2rem",border:"1px solid var(--accent-primary)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"1.5rem",textAlign:"center",background:"rgba(0,0,0,0.2)"},children:[e.jsx("h2",{className:"text-gradient",style:{textTransform:"uppercase",letterSpacing:"2px",marginBottom:"0.5rem",marginTop:0},children:"Komplett Ausgewertet!"}),e.jsxs("div",{style:{fontSize:"0.9rem",opacity:.8},children:["ðŸ† ",n.bettingResults.winner," | ðŸ’© ",n.bettingResults.loser]})]}),e.jsx("div",{style:{padding:"2rem",textAlign:"center",background:i>0?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)"},children:i>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.5rem"},children:"ðŸ¥³"}),e.jsx("h3",{style:{margin:0,color:"var(--accent-success)"},children:"GlÃ¼ckwunsch!"}),e.jsxs("p",{style:{fontSize:"1.2rem",margin:"0.5rem 0"},children:["Du hast ",e.jsx("strong",{children:h(i)})," gewonnen!"]}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Geh zum Admin fÃ¼r die Auszahlung."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.5rem"},children:"ðŸ“‰"}),e.jsx("h3",{style:{margin:0,color:"var(--accent-danger)"},children:"Knapp daneben!"}),e.jsx("p",{style:{margin:"0.5rem 0"},children:"Leider nichts gewonnen."}),e.jsx("div",{style:{fontSize:"0.8rem",opacity:.7},children:"Viel GlÃ¼ck beim nÃ¤chsten Mal! ðŸ€"})]})}),e.jsxs("div",{style:{padding:"1rem"},children:[e.jsx("h4",{style:{margin:"0 0 1rem 0",textTransform:"uppercase",fontSize:"0.8rem",opacity:.6,letterSpacing:"1px"},children:"Die GlÃ¼ckspilze (Payouts)"}),t.length>0?e.jsx("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},children:e.jsx("tbody",{children:t.map((r,m)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("td",{style:{padding:"8px",fontWeight:"bold"},children:r.user}),e.jsxs("td",{style:{padding:"8px"},children:[e.jsx("span",{style:{fontSize:"0.8rem",padding:"2px 6px",borderRadius:"4px",background:"rgba(255,255,255,0.05)",marginRight:"8px"},children:r.type==="winner"?"Sieg":"Verl."}),r.target]}),e.jsx("td",{style:{padding:"8px",textAlign:"right",color:"var(--accent-primary)",fontWeight:"bold"},children:h(r.amount)})]},m))})}):e.jsx("div",{style:{textAlign:"center",opacity:.5,padding:"1rem"},children:"Niemand hat gewonnen. Das Haus freut sich! ðŸ¦"})]})]})})(),n.bettingStatus==="open"&&e.jsxs("div",{className:"glass card",style:{padding:"1.5rem",marginBottom:"2rem"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"1.5rem",textAlign:"center"},children:"Neue Wette platzieren"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginBottom:"2rem"},children:[e.jsx("button",{onClick:()=>b("winner"),className:p==="winner"?"btn-primary":"btn-ghost",style:{flex:1,fontSize:"0.8rem"},children:"ðŸ† Sieger"}),e.jsx("button",{onClick:()=>b("loser"),className:p==="loser"?"btn-primary":"btn-ghost",style:{flex:1,fontSize:"0.8rem"},children:"ðŸ’© Verlierer"})]}),e.jsxs("form",{onSubmit:L,children:[e.jsx("p",{style:{textAlign:"center",opacity:.8,marginBottom:"1rem"},children:p==="winner"?"Wer gewinnt das Event?":"Wer wird Letzter?"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(130px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:n.guests?.filter(t=>t.status==="accepted").map(t=>{const s=c[`${p}_${t.name}`]||10;return e.jsxs("div",{onClick:()=>k(t.name),style:{padding:"12px",border:g===t.name?"2px solid var(--accent-primary)":"1px solid rgba(255,255,255,0.1)",background:g===t.name?"rgba(0,255,163,0.15)":"rgba(255,255,255,0.05)",borderRadius:"16px",cursor:"pointer",textAlign:"center",transition:"all 0.2s",transform:g===t.name?"scale(1.05)":"scale(1)"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",marginBottom:"4px"},children:t.name}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--accent-gold)",fontWeight:"bold"},children:["x ",s.toFixed(2)]})]},t.name)})}),e.jsx("div",{className:"glass",style:{padding:"1rem",borderRadius:"16px",background:"rgba(0,0,0,0.4)",marginTop:"auto"},children:e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"1px",opacity:.7},children:"Einsatz (â‚¬)"}),e.jsx("input",{type:"number",min:"1",step:"0.50",value:v,onChange:t=>S(t.target.value),className:"input-field",style:{marginBottom:0,fontSize:"1.2rem",fontWeight:"bold"}})]}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:!g,style:{flex:2,height:"56px",fontSize:"1.1rem"},children:"Wette platzieren"})]})})]})]}),B.length>0&&e.jsxs("div",{style:{marginBottom:"3rem"},children:[e.jsx("h3",{style:{paddingLeft:"0.5rem",borderLeft:"4px solid var(--accent-primary)",marginLeft:"0.5rem",marginBottom:"1.5rem"},children:"Deine Wetten"}),e.jsx("div",{style:{display:"grid",gap:"1rem"},children:B.map(t=>{let s=1;c[`${t.type}_${t.target}`]&&(s=c[`${t.type}_${t.target}`]);const i=t.amount*s;return e.jsx("div",{className:"glass",style:{padding:"1rem",borderRadius:"12px",display:"flex",justifyContent:"space-between",alignItems:"center",borderLeft:`4px solid ${t.type==="winner"?"#fbbf24":t.type==="loser"?"#ef4444":"#3b82f6"}`},children:e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:"bold",fontSize:"1.1rem"},children:[t.target," ",e.jsxs("span",{style:{opacity:.6,fontSize:"0.9rem",fontWeight:"normal"},children:["(",t.type==="winner"?"Sieg":t.type==="loser"?"Verlierer":"Volltreffer",")"]})]}),e.jsxs("div",{style:{fontSize:"0.9rem",marginTop:"4px",opacity:.8},children:["Einsatz: ",e.jsxs("strong",{children:[t.amount.toFixed(2),"â‚¬"]}),e.jsx("span",{style:{margin:"0 8px"},children:"â†’"}),"MÃ¶glich: ",e.jsxs("strong",{style:{color:"var(--accent-primary)"},children:[i.toFixed(2),"â‚¬"]}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.5,marginLeft:"5px"},children:["(x",s.toFixed(2),")"]})]})]})},t.id)})})]}),e.jsxs("div",{style:{marginTop:"3rem"},children:[e.jsx("h3",{style:{paddingLeft:"0.5rem",borderLeft:"4px solid rgba(255,255,255,0.5)",marginLeft:"0.5rem",marginBottom:"1.5rem",opacity:.8},children:"Aktuelle Quoten Ãœbersicht"}),e.jsx("div",{className:"glass",style:{padding:"1rem",borderRadius:"12px",overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9rem",minWidth:"300px"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"8px"},children:"Name"}),e.jsx("th",{style:{padding:"8px",color:"var(--accent-gold)"},children:"Sieg"}),e.jsx("th",{style:{padding:"8px",color:"#ef4444"},children:"Verl."})]})}),e.jsx("tbody",{children:n.guests?.filter(t=>t.status==="accepted").map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("td",{style:{padding:"8px",fontWeight:"bold"},children:t.name}),e.jsx("td",{style:{padding:"8px"},children:(c[`winner_${t.name}`]||1).toFixed(2)}),e.jsx("td",{style:{padding:"8px"},children:(c[`loser_${t.name}`]||1).toFixed(2)})]},t.name))})]})})]}),e.jsxs("div",{ref:z,style:{marginTop:"3rem",paddingBottom:"2rem"},children:[e.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.02)",display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:"12px 12px 0 0"},children:[e.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"ðŸ”¥ Live Ticker"}),e.jsxs("span",{style:{fontSize:"0.8rem",opacity:.6},children:[l.length," Wetten"]})]}),e.jsx("div",{className:"glass",style:{padding:"0",overflowX:"auto",borderRadius:"0 0 12px 12px"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem",minWidth:"350px"},children:[e.jsx("thead",{style:{background:"rgba(0,0,0,0.2)"},children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left",padding:"12px",fontWeight:"600",opacity:.8},children:"Zeit"}),e.jsx("th",{style:{textAlign:"left",padding:"12px",fontWeight:"600",opacity:.8},children:"Spieler"}),e.jsx("th",{style:{textAlign:"left",padding:"12px",fontWeight:"600",opacity:.8},children:"Wette"}),e.jsx("th",{style:{textAlign:"right",padding:"12px",fontWeight:"600",opacity:.8},children:"MÃ¶gl. Gewinn"})]})}),e.jsxs("tbody",{children:[l.slice().reverse().map((t,s)=>{const i=`${t.type}_${t.target}`,r=c&&c[i]||1,m=t.amount*r,R=t.timestamp?new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-";return e.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[e.jsx("td",{style:{padding:"12px",opacity:.5,fontSize:"0.75rem"},children:R}),e.jsx("td",{style:{padding:"12px",fontWeight:"500"},children:t.user}),e.jsxs("td",{style:{padding:"12px"},children:[e.jsx("div",{style:{background:t.type==="winner"?"rgba(234, 180, 8, 0.15)":"rgba(239, 68, 68, 0.15)",color:t.type==="winner"?"#eab308":"#ef4444",padding:"2px 6px",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold",display:"inline-block",marginBottom:"2px"},children:t.type==="winner"?"SIEG":"VERL."}),e.jsx("div",{style:{fontSize:"0.9rem"},children:t.target})]}),e.jsxs("td",{style:{padding:"12px",textAlign:"right",color:"var(--accent-primary)",fontWeight:"bold"},children:[h(m),e.jsxs("div",{style:{fontSize:"0.7rem",opacity:.5,fontWeight:"normal"},children:["Einsatz: ",h(t.amount)]})]})]},s)}),l.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",style:{padding:"2rem",textAlign:"center",opacity:.4},children:"Noch keine Wetten. Sei der Erste! ðŸš€"})})]})]})})]})]})}export{G as default};
